CREATE DATABASE NEWPETSHOP
USE NEWPETSHOP
--	KHACHANG (MAKH, HO_TENKH, DCKH, SDTKH)
CREATE TABLE KHACHHANG(
	MAKH CHAR(5) PRIMARY KEY,
	HO_TENKH NVARCHAR(20) NOT NULL,
	DCKH NVARCHAR(20) NOT NULL,
	SDTKH VARCHAR(10) NOT NULL
)
--	THUCUNG (MATC, TEN, GIONG, TUOI, MACN)
CREATE TABLE THUCUNG(
	MATC CHAR(5) PRIMARY KEY,
	MACN CHAR(5) FOREIGN KEY (MACN) REFERENCES KHACHHANG(MAKH),
	TEN NVARCHAR(10) NOT NULL,
	TUOI SMALLINT NOT NULL,
	GIONG NVARCHAR(30) NOT NULL
)
--	NHANVIEN (MANV, HO_TENNV, SĐT, LUONG)
CREATE TABLE NHANVIEN(
	MANV CHAR(5) PRIMARY KEY,
	HO_TENNV NVARCHAR(20) NOT NULL,
	SDT VARCHAR(10) NOT NULL,
	LUONG INT DEFAULT (1000000)
)
-- CALAMVIEC (BUOI, NGAY, MANV)
CREATE TABLE CALAMVIEC(
	BUOI NVARCHAR(10) NOT NULL,
	NGAY DATE NOT NULL,
	MANV CHAR(5) FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV),
	PRIMARY KEY(BUOI,NGAY,MANV)
)
--	HOADON (MAHD, NGAYLAP, TONGTIEN, MAKH, MANV)
CREATE TABLE HOADON(
	MAHD CHAR(5) PRIMARY KEY,
	MAKH CHAR(5) FOREIGN KEY (MAKH) REFERENCES KHACHHANG(MAKH),
	MANV CHAR(5) FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV),
	NGAYLAP DATE NOT NULL,
	TONGTIEN INT DEFAULT(0)
)
--	THUCAN (MATA, GIA, TEN)
CREATE TABLE THUCAN(
	MATA CHAR(5) PRIMARY KEY,
	TEN NVARCHAR(50) NOT NULL,
	GIA INT NOT NULL
)
--	DICHVU (MADV, TENDV, GIA)
CREATE TABLE DICHVU(
	MADV CHAR(5) PRIMARY KEY,
	TEN NVARCHAR(50) NOT NULL,
	GIA INT NOT NULL
)
--	CHITIETHD (MACT, MADV, MATA, SOLUONG, DONGIA, T_TIEN, MAHĐ)
CREATE TABLE CHITIETHD(
	MACT CHAR(10) PRIMARY KEY,
	MAHD CHAR(5) FOREIGN KEY (MAHD) REFERENCES HOADON(MAHD),
	MADV CHAR(5) FOREIGN KEY (MADV) REFERENCES DICHVU(MADV),
	MATA CHAR(5) FOREIGN KEY (MATA) REFERENCES THUCAN(MATA),
	SOLUONG SMALLINT DEFAULT(0),
	DONGIA INT DEFAULT(0),
	T_TIEN INT DEFAULT(0),
)
--	PHUCVU (MANV, MATC)
CREATE TABLE PHUCVU(
	MANV CHAR(5) FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV),
	MATC CHAR(5)FOREIGN KEY (MATC) REFERENCES THUCUNG(MATC),
	PRIMARY KEY(MANV,MATC)
)
-- THÊM VÀO BẢNG KHÁCH HÀNG
INSERT INTO KHACHHANG (MAKH,HO_TENKH,DCKH,SDTKH) VALUES ('M001', N'KHÁCH HÀNG 1 ', N'THỦ ĐỨC', '1779647139')
INSERT INTO KHACHHANG (MAKH,HO_TENKH,DCKH,SDTKH) VALUES ('M002', N'KHÁCH HÀNG 2', N'QUẬN 12', '8799654213')
INSERT INTO KHACHHANG (MAKH,HO_TENKH,DCKH,SDTKH) VALUES ('M003', N'KHÁCH HÀNG 3', N'QUẬN 2', '2277655341')
INSERT INTO KHACHHANG (MAKH,HO_TENKH,DCKH,SDTKH) VALUES ('M004', N'KHÁCH HÀNG 4', N'QUẬN 9', '8669925544')
INSERT INTO KHACHHANG (MAKH,HO_TENKH,DCKH,SDTKH) VALUES ('M005', N'KHÁCH HÀNG 5', N'THỦ ĐỨC', '7959502540')
INSERT INTO KHACHHANG (MAKH,HO_TENKH,DCKH,SDTKH) VALUES ('M006', N'KHÁCH HÀNG 6', N'BÌNH THẠNH', '9784512361')
INSERT INTO KHACHHANG (MAKH,HO_TENKH,DCKH,SDTKH) VALUES ('M007', N'KHÁCH HÀNG 7', N'GÒ VẤP', '9556663939')

-- THÊM VÀO BẢNG THÚ CƯNG
INSERT INTO THUCUNG (MATC,MACN,TEN,TUOI,GIONG) VALUES ('T001', 'M001', N'MILO', 2, N'POODLE')
INSERT INTO THUCUNG (MATC,MACN,TEN,TUOI,GIONG) VALUES ('T002', 'M001', N'GẤU', 2, N'CHÓ SĂN THỎ')
INSERT INTO THUCUNG (MATC,MACN,TEN,TUOI,GIONG) VALUES ('T003', 'M004', N'MUN', 1, N'MÈO TAM THỂ')
INSERT INTO THUCUNG (MATC,MACN,TEN,TUOI,GIONG) VALUES ('T004', 'M002', N'BÍ', 3, N'CHÓ BULL')
INSERT INTO THUCUNG (MATC,MACN,TEN,TUOI,GIONG) VALUES ('T005', 'M007', N'MIMI', 1, N'MÈO ANH')
INSERT INTO THUCUNG (MATC,MACN,TEN,TUOI,GIONG) VALUES ('T006', 'M005', N'LULU', 3, N'HUSKY')
INSERT INTO THUCUNG (MATC,MACN,TEN,TUOI,GIONG) VALUES ('T007', 'M003', N'HOÀNG', 4, N'CHÓ ĐỐM')
INSERT INTO THUCUNG (MATC,MACN,TEN,TUOI,GIONG) VALUES ('T008', 'M006', N'SUNG', 2, N'CHIHUAHUA')

-- THÊM VÀO BẢNG DỊCH VỤ
INSERT INTO DICHVU (MADV,TEN,GIA) VALUES ('D001', N'TẮM',150000)
INSERT INTO DICHVU (MADV,TEN,GIA) VALUES ('D002', N'CẮT LÔNG',200000)
INSERT INTO DICHVU (MADV,TEN,GIA) VALUES ('D003', N'TỈA LÔNG',250000)
INSERT INTO DICHVU (MADV,TEN,GIA) VALUES ('D004', N'VỆ SINH TAI',300000)
INSERT INTO DICHVU (MADV,TEN,GIA) VALUES ('D005', N'SPA MÓNG',300000)
INSERT INTO DICHVU (MADV,TEN,GIA) VALUES ('D006', N'MASSAGE THƯ GIÃN',400000)
INSERT INTO DICHVU (MADV,TEN,GIA) VALUES ('D007', N'DƯỠNG LÔNG',500000)
INSERT INTO DICHVU (MADV,TEN,GIA) VALUES ('D008', N'VỆ SINH TUYẾN MỒ HÔI',350000)
INSERT INTO DICHVU (MADV,TEN,GIA) VALUES ('D009', N'PHỐI GIỐNG', 1000000)
INSERT INTO DICHVU (MADV,TEN,GIA) VALUES ('D010', N'KHÁCH SẠN THÚ CƯNG',200000)

-- THÊM VÀO BẢNG THỨC ĂN
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('DOG1', N'THỨC ĂN CHO CHÓ LỚN CP CLASSIC VỊ BÒ',100000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('DOG2', N'THỨC ĂN CHO CHÓ HOMEDOG VỊ BÒ VÀ RAU',135000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('DOG3', N'THỨC ĂN CHO CHÓ PEDIGREE VỊ GÀ & RAU CỦ',115000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('DOG4', N'THỨC ĂN CAO CẤP NUTRISOURCE THỊT CÁ HỒI TƯƠI',160000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('DOG5', N'THỨC ĂN CAO CẤP PUAREVITA CÁ HỒI & ĐẬU HÀ LAN',200000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('DOG6', N'THỨC ĂN RAOYAL CANNIN CHIHUAHUA JUNIOR',400000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('DOG7', N'THỨC ĂN CAO CẤP PUREVITA GÀ TÂY & KHOAI LANG',350000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('DOG8', N'THỨC ĂN CHO CHÓ LỚN SMART HEART VỊ BÒ',200000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('DOG9', N'THỨC ĂN BRISTISH SHORTHAIR 400G',190000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('DOG10', N'THỨC ĂN CHO CHÓ NHỎ', 260000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('CAT1', N'THỨC ĂN CHO MÈO CATS EYE',180000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('CAT2', N'THỨC ĂN CHO MÈO HOME CAT',210000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('CAT3', N'THỨC ĂN CHO MÈO TRƯỞNG THÀNH ISKHAN',150000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('CAT4', N'THỨC ĂN CHO MÈO ROYAL CANIN KITTEN', 135000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('CAT5', N'THỨC ĂN CHO MÈO ROYAL CANIN INDOOR', 250000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('CAT6', N'THỨC ĂN CHO MÈO ROYAL CANIN STERILISED', 235000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('CAT7', N'THỨC ĂN CHO MÈO ROYAL CANIN FIT', 430000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('CAT8', N'THỨC ĂN CHO MÈO ROYAL CANIN PRESIAN KITTEN', 300000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('CAT9', N'SỮA CHO MÈO CON CHAI 500ML', 50000)
INSERT INTO THUCAN(MATA,TEN,GIA) VALUES ('CAT10', N'SỮA CHO MÈO CON CHAI 1L', 90000)

-- THÊM VÀO BẢNG NHÂN VIÊN
INSERT INTO NHANVIEN (MANV,HO_TENNV,SDT,LUONG) VALUES ('N001', N'NGUYỄN VĂN AN', '8784564847', 3000000)
INSERT INTO NHANVIEN (MANV,HO_TENNV,SDT,LUONG) VALUES ('N002', N'PHẠM TRỌNG MINH', '7984156153', 3550000)
INSERT INTO NHANVIEN (MANV,HO_TENNV,SDT,LUONG) VALUES ('N003', N'LÊ THÀNH NAM', '9878887465', 5000000)
INSERT INTO NHANVIEN (MANV,HO_TENNV,SDT,LUONG) VALUES ('N004', N'LÊ THỊ THU UYÊN', '9866632144', 4860000)
INSERT INTO NHANVIEN (MANV,HO_TENNV,SDT,LUONG) VALUES ('N005', N'TRẦN TỐ NHƯ', '3665421469', 3880000)
INSERT INTO NHANVIEN (MANV,HO_TENNV,SDT,LUONG) VALUES ('N006', N'NGUYỄN KHÁNH AN', '4654612317', 6000000)
INSERT INTO NHANVIEN (MANV,HO_TENNV,SDT,LUONG) VALUES ('N007', N'LÊ MINH THÀNH', '9798465132', 5270000)
INSERT INTO NHANVIEN (MANV,HO_TENNV,SDT,LUONG) VALUES ('N008', N'NGUYỄN HỮU', '8451648948', 4300000)
INSERT INTO NHANVIEN (MANV,HO_TENNV,SDT,LUONG) VALUES ('N009', N'TỪ MINH HƯNG', '9415617841', 5500000)
INSERT INTO NHANVIEN (MANV,HO_TENNV,SDT,LUONG) VALUES ('N010', N'VÕ HÙNG ANH', '9874154813', 4290000)
INSERT INTO NHANVIEN (MANV,HO_TENNV,SDT,LUONG) VALUES ('N011', N'NGUYỄN THÁI THỦY', '9841617332', 5750000)
INSERT INTO NHANVIEN (MANV,HO_TENNV,SDT,LUONG) VALUES ('N012', N'PHAN HOÀNG KHÁNH', '7898545145', 5980000)

-- THÊM VÀO BẢNG CA LÀM VIỆC (ngày làm việc được tính từ ngày 01-05 đến ngày 12-05)
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-01-05', 'N001')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-01-05', 'N005')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-01-05', 'N003')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-01-05', 'N011')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-01-05', 'N006')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-01-05', 'N012')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-01-05', 'N004')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-02-05', 'N003')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-02-05', 'N011')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-02-05', 'N006')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-02-05', 'N008')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-02-05', 'N008')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-02-05', 'N004')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-02-05', 'N012')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-03-05', 'N007')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-03-05', 'N005')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-03-05', 'N012')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-03-05', 'N002')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-03-05', 'N006')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-03-05', 'N003')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-04-05', 'N008')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-04-05', 'N006')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-04-05', 'N004')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-04-05', 'N007')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-04-05', 'N003')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-04-05', 'N011')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-05-05', 'N001')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-05-05', 'N005')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-05-05', 'N010')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-05-05', 'N006')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-05-05', 'N004')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-05-05', 'N012')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-06-05', 'N007')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-06-05', 'N008')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-06-05', 'N011')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-06-05', 'N004')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-06-05', 'N006')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-06-05', 'N012')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-07-05', 'N010')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-07-05', 'N009')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-07-05', 'N003')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-07-05', 'N001')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-07-05', 'N009')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-07-05', 'N006')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-07-05', 'N002')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-08-05', 'N006')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-08-05', 'N009')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-08-05', 'N011')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-08-05', 'N005')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-08-05', 'N007')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-08-05', 'N006')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-08-05', 'N004')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-09-05', 'N008')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-09-05', 'N012')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-09-05', 'N007')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-09-05', 'N009')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-09-05', 'N003')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-09-05', 'N005')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-10-05', 'N010')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-10-05', 'N006')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-10-05', 'N002')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-10-05', 'N011')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-10-05', 'N010')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-10-05', 'N011')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-10-05', 'N009')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-11-05', 'N012')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-11-05', 'N011')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-11-05', 'N004')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-11-05', 'N008')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-11-05', 'N006')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-11-05', 'N007')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-12-05', 'N012')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-12-05', 'N003')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'SÁNG', '2020-12-05', 'N006')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-12-05', 'N010')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-12-05', 'N002')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-12-05', 'N012')
INSERT INTO CALAMVIEC (BUOI,NGAY,MANV) VALUES (N'CHIỀU', '2020-12-05', 'N009')

-- THÊM VÀO BẢNG PHỤC VỤ
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N001','T004')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N007','T006')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N006','T002')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N008','T003')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N005','T008')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N007','T001')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N002','T007')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N004','T005')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N009','T001')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N010','T004')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N011','T002')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N006','T001')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N012','T006')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N004','T008')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N010','T006')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N001','T005')
INSERT INTO PHUCVU (MANV,MATC) VALUES ('N002','T003')

-- THÊM VÀO BẢNG HÓA ĐƠN
INSERT INTO HOADON (MAHD,MAKH,MANV,NGAYLAP,TONGTIEN) VALUES ('H001','M001','N005','2020-01-05',1395000)
INSERT INTO HOADON (MAHD,MAKH,MANV,NGAYLAP,TONGTIEN) VALUES ('H002','M005','N006','2020-02-05',1050000)
INSERT INTO HOADON (MAHD,MAKH,MANV,NGAYLAP,TONGTIEN) VALUES ('H003','M006','N003','2020-01-05',1500000)
INSERT INTO HOADON (MAHD,MAKH,MANV,NGAYLAP,TONGTIEN) VALUES ('H004','M002','N003','2020-03-05',1120000)
INSERT INTO HOADON (MAHD,MAKH,MANV,NGAYLAP,TONGTIEN) VALUES ('H005','M001','N011','2020-06-05',520000)
INSERT INTO HOADON (MAHD,MAKH,MANV,NGAYLAP,TONGTIEN) VALUES ('H006','M004','N002','2020-04-05',1420000)
INSERT INTO HOADON (MAHD,MAKH,MANV,NGAYLAP,TONGTIEN) VALUES ('H007','M003','N008','2020-04-05',450000)
INSERT INTO HOADON (MAHD,MAKH,MANV,NGAYLAP,TONGTIEN) VALUES ('H008','M002','N004','2020-05-05',1700000)
INSERT INTO HOADON (MAHD,MAKH,MANV,NGAYLAP,TONGTIEN) VALUES ('H009','M007','N012','2020-05-05',2155000)
INSERT INTO HOADON (MAHD,MAKH,MANV,NGAYLAP,TONGTIEN) VALUES ('H010','M003','N007','2020-03-05',1180000)
INSERT INTO HOADON (MAHD,MAKH,MANV,NGAYLAP,TONGTIEN) VALUES ('H010','M001','N006','2020-03-05',1190000)
INSERT INTO HOADON (MAHD,MAKH,MANV,NGAYLAP,TONGTIEN) VALUES ('H010','M001','N003','2020-03-05',500000)
-- THÊM VÀO BẢNG CHI TIẾT HÓA ĐƠN
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT1H1','H001','D001',1,150000,150000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT1H2','H002','D005',1,300000,300000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT1H3','H003','D003',1,250000,250000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT1H4','H004','D006',1,400000,400000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT1H6','H006','D003',1,250000,250000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT1H7','H007','D001',1,150000,150000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT1H8','H008','D010',5,200000,1000000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT1H9','H009','D007',1,500000,500000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT2H3','H003','D004',1,300000,300000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT2H7','H007','D005',1,300000,300000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT2H9','H009','D003',1,250000,250000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT3H2','H002','D002',1,200000,200000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT3H4','H004','D001',1,150000,150000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT3H9','H009','D008',1,350000,350000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT4H1','H001','D005',1,300000,300000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT4H2','H002','D008',1,350000,350000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT4H3','H003','D001',1,150000,150000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT4H6','H006','D006',1,400000,400000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT1H10','H010','DOG8',4,200000,800000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT1H5','H005','DOG10',2,260000,520000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT2H1','H001','DOG2',2,135000,270000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT2H10','H010','DOG9',2,190000,380000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT2H2','H002','DOG5',1,200000,200000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT2H4','H004','DOG9',3,190000,570000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT2H6','H006','CAT10',3,90000,270000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT2H8','H008','DOG7',2,350000,700000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT3H1','H001','DOG3',5,115000,575000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT3H3','H003','DOG6',2,400000,800000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT3H6','H006','CAT5',2,250000,500000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT4H9','H009','CAT6',3,235000,705000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT5H1','H001','DOG1',1,100000,100000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT5H9','H009','CAT9',5,50000,250000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT6H9','H009','CAT3',2,150000,300000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT1H11','H011','D001',1,150000,150000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT2H11','H011','DOG2',4,135000,540000)
INSERT INTO CHITIETHD (MACT,MAHD,MADV,SOLUONG,DONGIA,T_TIEN) VALUES ('CT3H11','H011','D007',1,500000,500000)
INSERT INTO CHITIETHD (MACT,MAHD,MATA,SOLUONG,DONGIA,T_TIEN) VALUES ('CT1H12','H012','D007',1,500000,500000)

-- CÂU LỆNH SHOW CÁC BẢNG TRONG CƠ SỞ DỮ LIỆU PET SHOP
SELECT * FROM KHACHHANG
SELECT * FROM THUCUNG
SELECT * FROM NHANVIEN
SELECT * FROM DICHVU
SELECT * FROM THUCAN
SELECT * FROM HOADON
SELECT * FROM CHITIETHD
SELECT * FROM CALAMVIEC
SELECT * FROM PHUCVU

-- CÁC CÂU LỆNH TRUY VẤN KHÁC (minh họa)
	-- câu 1: cho biết THÔNG TIN  các khách hàng có từ 2 thú cưng trở lên
	SELECT *
	FROM KHACHHANG KH
	WHERE EXISTS (
	SELECT MACN, COUNT(*) AS 'SO THU CUNG'
	FROM THUCUNG TC
	GROUP BY MACN
	HAVING COUNT(*) >=2 AND KH.MAKH = TC.MACN)
	-- CÂU 2: Cho biết thú cưng nào lớn tuổi nhất?
	SELECT TOP 1 *
	FROM THUCUNG
	ORDER BY TUOI DESC
	-- CÂU 3: Hãy xuất ra những nhân viên có lương > 4500000?
	SELECT *
	FROM NHANVIEN
	WHERE LUONG > 4500000
	-- CÂU 4: Hãy xuất ra danh sách các thức ăn dành riêng cho thú cưng là chó (hoặc mèo)?
	SELECT *
	FROM THUCAN
	WHERE MATA LIKE 'CAT%'

	SELECT *
	FROM THUCAN
	WHERE MATA LIKE 'DOG%'
	-- CÂU 5: SẮP LƯƠNG NHÂN VIÊN TỪ CAO XUỐNG THẤP
	SELECT MANV, LUONG
	FROM NHANVIEN
	ORDER BY LUONG DESC
	-- CÂU 6: CHO BIẾT MỖI NHÂN VIÊN LÀM VIỆC BAO NHIÊU BUỔI?
	SELECT MANV, COUNT(*) AS 'SO BUOI LAM VIEC'
	FROM CALAMVIEC
	GROUP BY MANV
	-- CÂU 7: CHO BIẾT TÊN NHỮNG THÚ CƯNG CÓ ĐỊA CHỈ CHỦ NHÂN Ở 'THỦ ĐỨC'?
	SELECT TEN
	FROM KHACHHANG K, THUCUNG T
	WHERE K.MAKH = T.MACN AND K.DCKH = N'THỦ ĐỨC'
	-- CÂU 8: HÃY CHO BIẾT KHÁCH HÀNG NÀO CÓ NHIỀU HÓA ĐƠN NHẤT?
	SELECT TOP 1 MAKH, COUNT(*) AS 'SO LUONG HOA DON'
	FROM HOADON
	GROUP BY MAKH
	-- CÂU 9: Cho biết khách hàng có hóa đơn nhiều tiền nhất?
	SELECT HO_TENKH, MAHD, TONGTIEN
	FROM KHACHHANG K, HOADON H
	WHERE K.MAKH = H.MAKH AND K.MAKH IN
	(SELECT TOP 1 MAKH
	FROM HOADON
	ORDER BY TONGTIEN DESC)
	-- CÂU 10: CHO BIẾT CÁC NHÂN VIÊN PHỤC VỤ CHO THÚ CƯNG CÓ MATC LÀ 'T005'?
	SELECT HO_TENNV
	FROM PHUCVU P, NHANVIEN NV
	WHERE P.MANV = NV.MANV AND P.MATC = 'T005'
	-- CÂU 11: CHO BIẾT THÔNG TIN NHÂN VIÊN (TRỪ CỘT LƯƠNG) NÀO KHÔNG ĐI LÀM TRONG NGÀY '10-05-2020'?
	SELECT MANV, HO_TENNV, SDT
	FROM NHANVIEN
	WHERE MANV NOT IN
	(SELECT MANV
	FROM CALAMVIEC
	WHERE NGAY = '10-05-2020')
	-- CÂU 12: CHO BIẾT SỐ LƯỢNG CHITIETHD CỦA MỖI HOADON?
	SELECT MAHD, COUNT(*) 'SO LUONG CTHD'
	FROM CHITIETHD
	GROUP BY MAHD
	-- CÂU 13: HÃY CHO BIẾT NHÂN VIÊN CÓ MÃ 'N008' ĐI LÀM NHỮNG NGÀY NÀO?
	SELECT MANV, NGAY
	FROM CALAMVIEC
	WHERE MANV = 'N008'
	-- Câu 14: Hãy cho biết những hóa đơn được xuất ra trong ngày ’01-05-2020’?
	SELECT *
	FROM HOADON
	WHERE NGAYLAP = '01-05-2020'
	-- Câu 15: Hãy cho biết thông tin của khách hàng có hóa đơn được xuất trong ngày ’05-05-2020’ và được lập bởi nhân viên có mã ‘N012’?
	SELECT *
	FROM KHACHHANG
	WHERE MAKH =
	(SELECT MAKH
	FROM HOADON
	WHERE NGAYLAP = '05-05-2020' AND MANV = 'N012')
	-- Câu 16: Hãy cho biết những chi tiết hóa đơn nào lựa chọn dịch vụ có mã ‘D001’?
	SELECT MACT, MAHD
	FROM CHITIETHD
	WHERE MADV = 'D001'
	-- Câu 17: Hãy cho biết THÔNG TIN những hóa đơn có mua thức ăn cho thú cưng?
	SELECT *
	FROM HOADON H
	WHERE H.MAHD IN
	(SELECT CT.MAHD
	FROM CHITIETHD CT
	WHERE MATA LIKE 'DOG%' OR MATA LIKE 'CAT%')
	-- Câu 18: Hãy cho biết thông tin những thú cưng trên 2 tuổi và chủ của nó?
	SELECT MAKH ,HO_TENKH, DCKH, MATC, TEN, GIONG, TUOI
	FROM KHACHHANG, THUCUNG
	WHERE TUOI > 2 AND MAKH =MACN
	-- Câu 19: Hãy cho biết những khách hàng có địa chỉ ở quận 2?
	SELECT *
	FROM KHACHHANG
	WHERE DCKH = N'QUẬN 2'
	-- Câu 20: Hãy cho biết thông tin nhân viên mã ‘N010’ có phục vụ thú cưng nào không?
	SELECT *
	FROM PHUCVU
	WHERE MANV ='N010'
